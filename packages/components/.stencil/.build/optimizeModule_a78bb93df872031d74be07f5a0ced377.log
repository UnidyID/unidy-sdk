import{r as e,c as t,h as r}from"./p-DEEfufMc.js";var n=Object.defineProperty;var i=(e,t)=>{for(var r in t)n(e,r,{get:t[r],enumerable:true,configurable:true,set:e=>t[r]=()=>e})};class o{baseUrl;api_key;constructor(e,t){this.baseUrl=e;this.api_key=t;this.api_key=t}buildHeaders(e){return{...{"Content-Type":"application/json",Accept:"application/json",Authorization:`Bearer ${this.api_key}`},...e??{}}}async post(e,t,r){let n=null;try{n=await fetch(`${this.baseUrl}${e}`,{method:"POST",mode:"cors",headers:this.buildHeaders(r?.headers),body:JSON.stringify(t)});let i;try{i=await n.json()}catch(e){i=void 0}return{data:i,status:n.status,headers:n.headers,success:n.ok}}catch(e){return{status:n?n.status:e instanceof TypeError?0:500,error:e instanceof Error?e.message:String(e),headers:n?n.headers:new Headers,success:false}}}}function s(e,t,r){function n(r,n){var i;Object.defineProperty(r,"_zod",{value:r._zod??{},enumerable:false}),(i=r._zod).traits??(i.traits=new Set),r._zod.traits.add(e),t(r,n);for(let e in s.prototype)if(!(e in r))Object.defineProperty(r,e,{value:s.prototype[e].bind(r)});r._zod.constr=s,r._zod.def=n}let i=r?.Parent??Object;class o extends i{}Object.defineProperty(o,"name",{value:e});function s(e){var t;let i=r?.Parent?new o:this;n(i,e),(t=i._zod).deferred??(t.deferred=[]);for(let e of i._zod.deferred)e();return i}return Object.defineProperty(s,"init",{value:n}),Object.defineProperty(s,Symbol.hasInstance,{value:t=>{if(r?.Parent&&t instanceof r.Parent)return true;return t?._zod?.traits?.has(e)}}),Object.defineProperty(s,"name",{value:e}),s}class a extends Error{constructor(){super("Encountered Promise during synchronous parse. Use .parseAsync() instead.")}}var l={};function u(e){return l}var c={};i(c,{unwrapMessage:()=>te,stringifyPrimitive:()=>D,required:()=>Q,randomString:()=>R,propertyKeyTypes:()=>L,promiseAllObject:()=>O,primitiveTypes:()=>Z,prefixIssues:()=>ee,pick:()=>G,partial:()=>Y,optionalKeys:()=>q,omit:()=>V,numKeys:()=>C,nullish:()=>g,normalizeParams:()=>F,mergeDefs:()=>$,merge:()=>H,jsonStringifyReplacer:()=>y,joinValues:()=>w,issue:()=>oe,isPlainObject:()=>A,isObject:()=>M,getSizableOrigin:()=>ne,getParsedType:()=>z,getLengthableOrigin:()=>ie,getEnumValues:()=>b,getElementAtPath:()=>S,floatSafeRemainder:()=>_,finalizeIssue:()=>re,extend:()=>W,escapeRegex:()=>I,esc:()=>T,defineLazy:()=>k,createTransparentProxy:()=>B,cloneDef:()=>j,clone:()=>U,cleanRegex:()=>x,cleanEnum:()=>se,captureStackTrace:()=>P,cached:()=>v,assignProp:()=>E,assertNotEqual:()=>d,assertNever:()=>p,assertIs:()=>h,assertEqual:()=>f,assert:()=>m,allowsEval:()=>N,aborted:()=>X,NUMBER_FORMAT_RANGES:()=>J,Class:()=>ae,BIGINT_FORMAT_RANGES:()=>K});function f(e){return e}function d(e){return e}function h(e){}function p(e){throw new Error}function m(e){}function b(e){let t=Object.values(e).filter((e=>typeof e==="number"));return Object.entries(e).filter((([e,r])=>t.indexOf(+e)===-1)).map((([e,t])=>t))}function w(e,t="|"){return e.map((e=>D(e))).join(t)}function y(e,t){if(typeof t==="bigint")return t.toString();return t}function v(e){return{get value(){{let t=e();return Object.defineProperty(this,"value",{value:t}),t}}}}function g(e){return e===null||e===void 0}function x(e){let t=e.startsWith("^")?1:0,r=e.endsWith("$")?e.length-1:e.length;return e.slice(t,r)}function _(e,t){let r=(e.toString().split(".")[1]||"").length,n=(t.toString().split(".")[1]||"").length,i=r>n?r:n,o=Number.parseInt(e.toFixed(i).replace(".","")),s=Number.parseInt(t.toFixed(i).replace(".",""));return o%s/10**i}function k(e,t,r){Object.defineProperty(e,t,{get(){{let n=r();return e[t]=n,n}},set(r){Object.defineProperty(e,t,{value:r})},configurable:true})}function E(e,t,r){Object.defineProperty(e,t,{value:r,writable:true,enumerable:true,configurable:true})}function $(...e){let t={};for(let r of e){let e=Object.getOwnPropertyDescriptors(r);Object.assign(t,e)}return Object.defineProperties({},t)}function j(e){return $(e._zod.def)}function S(e,t){if(!t)return e;return t.reduce(((e,t)=>e?.[t]),e)}function O(e){let t=Object.keys(e),r=t.map((t=>e[t]));return Promise.all(r).then((e=>{let r={};for(let n=0;n<t.length;n++)r[t[n]]=e[n];return r}))}function R(e=10){let t="";for(let r=0;r<e;r++)t+="abcdefghijklmnopqrstuvwxyz"[Math.floor(Math.random()*26)];return t}function T(e){return JSON.stringify(e)}var P="captureStackTrace"in Error?Error.captureStackTrace:(...e)=>{};function M(e){return typeof e==="object"&&e!==null&&!Array.isArray(e)}var N=v((()=>{if(typeof navigator!=="undefined"&&navigator?.userAgent?.includes("Cloudflare"))return false;try{return new Function(""),true}catch(e){return false}}));function A(e){if(M(e)===false)return false;let t=e.constructor;if(t===void 0)return true;let r=t.prototype;if(M(r)===false)return false;if(Object.prototype.hasOwnProperty.call(r,"isPrototypeOf")===false)return false;return true}function C(e){let t=0;for(let r in e)if(Object.prototype.hasOwnProperty.call(e,r))t++;return t}var z=e=>{let t=typeof e;switch(t){case"undefined":return"undefined";case"string":return"string";case"number":return Number.isNaN(e)?"nan":"number";case"boolean":return"boolean";case"function":return"function";case"bigint":return"bigint";case"symbol":return"symbol";case"object":if(Array.isArray(e))return"array";if(e===null)return"null";if(e.then&&typeof e.then==="function"&&e.catch&&typeof e.catch==="function")return"promise";if(typeof Map!=="undefined"&&e instanceof Map)return"map";if(typeof Set!=="undefined"&&e instanceof Set)return"set";if(typeof Date!=="undefined"&&e instanceof Date)return"date";if(typeof File!=="undefined"&&e instanceof File)return"file";return"object";default:throw new Error(`Unknown data type: ${t}`)}},L=new Set(["string","number","symbol"]),Z=new Set(["string","number","bigint","boolean","symbol","undefined"]);function I(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function U(e,t,r){let n=new e._zod.constr(t??e._zod.def);if(!t||r?.parent)n._zod.parent=e;return n}function F(e){let t=e;if(!t)return{};if(typeof t==="string")return{error:()=>t};if(t?.message!==void 0){if(t?.error!==void 0)throw new Error("Cannot specify both `message` and `error` params");t.error=t.message}if(delete t.message,typeof t.error==="string")return{...t,error:()=>t.error};return t}function B(e){let t;return new Proxy({},{get(r,n,i){return t??(t=e()),Reflect.get(t,n,i)},set(r,n,i,o){return t??(t=e()),Reflect.set(t,n,i,o)},has(r,n){return t??(t=e()),Reflect.has(t,n)},deleteProperty(r,n){return t??(t=e()),Reflect.deleteProperty(t,n)},ownKeys(r){return t??(t=e()),Reflect.ownKeys(t)},getOwnPropertyDescriptor(r,n){return t??(t=e()),Reflect.getOwnPropertyDescriptor(t,n)},defineProperty(r,n,i){return t??(t=e()),Reflect.defineProperty(t,n,i)}})}function D(e){if(typeof e==="bigint")return e.toString()+"n";if(typeof e==="string")return`"${e}"`;return`${e}`}function q(e){return Object.keys(e).filter((t=>e[t]._zod.optin==="optional"&&e[t]._zod.optout==="optional"))}var J={safeint:[Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],int32:[-2147483648,2147483647],uint32:[0,4294967295],float32:[-34028234663852886e22,34028234663852886e22],float64:[-Number.MAX_VALUE,Number.MAX_VALUE]},K={int64:[BigInt("-9223372036854775808"),BigInt("9223372036854775807")],uint64:[BigInt(0),BigInt("18446744073709551615")]};function G(e,t){let r=e._zod.def,n=$(e._zod.def,{get shape(){let e={};for(let n in t){if(!(n in r.shape))throw new Error(`Unrecognized key: "${n}"`);if(!t[n])continue;e[n]=r.shape[n]}return E(this,"shape",e),e},checks:[]});return U(e,n)}function V(e,t){let r=e._zod.def,n=$(e._zod.def,{get shape(){let n={...e._zod.def.shape};for(let e in t){if(!(e in r.shape))throw new Error(`Unrecognized key: "${e}"`);if(!t[e])continue;delete n[e]}return E(this,"shape",n),n},checks:[]});return U(e,n)}function W(e,t){if(!A(t))throw new Error("Invalid input to extend: expected a plain object");let r=$(e._zod.def,{get shape(){let r={...e._zod.def.shape,...t};return E(this,"shape",r),r},checks:[]});return U(e,r)}function H(e,t){let r=$(e._zod.def,{get shape(){let r={...e._zod.def.shape,...t._zod.def.shape};return E(this,"shape",r),r},get catchall(){return t._zod.def.catchall},checks:[]});return U(e,r)}function Y(e,t,r){let n=$(t._zod.def,{get shape(){let n=t._zod.def.shape,i={...n};if(r)for(let t in r){if(!(t in n))throw new Error(`Unrecognized key: "${t}"`);if(!r[t])continue;i[t]=e?new e({type:"optional",innerType:n[t]}):n[t]}else for(let t in n)i[t]=e?new e({type:"optional",innerType:n[t]}):n[t];return E(this,"shape",i),i},checks:[]});return U(t,n)}function Q(e,t,r){let n=$(t._zod.def,{get shape(){let n=t._zod.def.shape,i={...n};if(r)for(let t in r){if(!(t in i))throw new Error(`Unrecognized key: "${t}"`);if(!r[t])continue;i[t]=new e({type:"nonoptional",innerType:n[t]})}else for(let t in n)i[t]=new e({type:"nonoptional",innerType:n[t]});return E(this,"shape",i),i},checks:[]});return U(t,n)}function X(e,t=0){for(let r=t;r<e.issues.length;r++)if(e.issues[r]?.continue!==true)return true;return false}function ee(e,t){return t.map((t=>{var r;return(r=t).path??(r.path=[]),t.path.unshift(e),t}))}function te(e){return typeof e==="string"?e:e?.message}function re(e,t,r){let n={...e,path:e.path??[]};if(!e.message){let i=te(e.inst?._zod.def?.error?.(e))??te(t?.error?.(e))??te(r.customError?.(e))??te(r.localeError?.(e))??"Invalid input";n.message=i}if(delete n.inst,delete n.continue,!t?.reportInput)delete n.input;return n}function ne(e){if(e instanceof Set)return"set";if(e instanceof Map)return"map";if(e instanceof File)return"file";return"unknown"}function ie(e){if(Array.isArray(e))return"array";if(typeof e==="string")return"string";return"unknown"}function oe(...e){let[t,r,n]=e;if(typeof t==="string")return{message:t,code:"custom",input:r,inst:n};return{...t}}function se(e){return Object.entries(e).filter((([e,t])=>Number.isNaN(Number.parseInt(e,10)))).map((e=>e[1]))}class ae{constructor(...e){}}var le=(e,t)=>{e.name="$ZodError",Object.defineProperty(e,"_zod",{value:e._zod,enumerable:false}),Object.defineProperty(e,"issues",{value:t,enumerable:false}),e.message=JSON.stringify(t,y,2),Object.defineProperty(e,"toString",{value:()=>e.message,enumerable:false})},ue=s("$ZodError",le),ce=s("$ZodError",le,{Parent:Error});var fe=e=>(t,r,n,i)=>{let o=n?Object.assign(n,{async:false}):{async:false},s=t._zod.run({value:r,issues:[]},o);if(s instanceof Promise)throw new a;if(s.issues.length){let t=new(i?.Err??e)(s.issues.map((e=>re(e,o,u()))));throw P(t,i?.callee),t}return s.value},de=fe(ce),he=e=>async(t,r,n,i)=>{let o=n?Object.assign(n,{async:true}):{async:true},s=t._zod.run({value:r,issues:[]},o);if(s instanceof Promise)s=await s;if(s.issues.length){let t=new(i?.Err??e)(s.issues.map((e=>re(e,o,u()))));throw P(t,i?.callee),t}return s.value},pe=he(ce),me=e=>(t,r,n)=>{let i=n?{...n,async:false}:{async:false},o=t._zod.run({value:r,issues:[]},i);if(o instanceof Promise)throw new a;return o.issues.length?{success:false,error:new(e??ue)(o.issues.map((e=>re(e,i,u()))))}:{success:true,data:o.value}},be=me(ce),we=e=>async(t,r,n)=>{let i=n?Object.assign(n,{async:true}):{async:true},o=t._zod.run({value:r,issues:[]},i);if(o instanceof Promise)o=await o;return o.issues.length?{success:false,error:new e(o.issues.map((e=>re(e,i,u()))))}:{success:true,data:o.value}},ye=we(ce);var ve=e=>{let t=e?`[\\s\\S]{${e?.minimum??0},${e?.maximum??""}}`:"[\\s\\S]*";return new RegExp(`^${t}$`)};var ge=/^-?\d+(?:\.\d+)?/i,xe=/true|false/i,_e=/null/i;class ke{constructor(e=[]){if(this.content=[],this.indent=0,this)this.args=e}indented(e){this.indent+=1,e(this),this.indent-=1}write(e){if(typeof e==="function"){e(this,{execution:"sync"}),e(this,{execution:"async"});return}let t=e.split(`\n`).filter((e=>e)),r=Math.min(...t.map((e=>e.length-e.trimStart().length))),n=t.map((e=>e.slice(r))).map((e=>" ".repeat(this.indent*2)+e));for(let e of n)this.content.push(e)}compile(){let e=Function,t=this?.args,r=[...(this?.content??[""]).map((e=>`  ${e}`))];return new e(...t,r.join(`\n`))}}var Ee={major:4,minor:0,patch:10};var $e=s("$ZodType",((e,t)=>{var r;e??(e={}),e._zod.def=t,e._zod.bag=e._zod.bag||{},e._zod.version=Ee;let n=[...e._zod.def.checks??[]];if(e._zod.traits.has("$ZodCheck"))n.unshift(e);for(let t of n)for(let r of t._zod.onattach)r(e);if(n.length===0)(r=e._zod).deferred??(r.deferred=[]),e._zod.deferred?.push((()=>{e._zod.run=e._zod.parse}));else{let t=(e,t,r)=>{let n=X(e),i;for(let o of t){if(o._zod.def.when){if(!o._zod.def.when(e))continue}else if(n)continue;let t=e.issues.length,s=o._zod.check(e);if(s instanceof Promise&&r?.async===false)throw new a;if(i||s instanceof Promise)i=(i??Promise.resolve()).then((async()=>{if(await s,e.issues.length===t)return;if(!n)n=X(e,t)}));else{if(e.issues.length===t)continue;if(!n)n=X(e,t)}}if(i)return i.then((()=>e));return e};e._zod.run=(r,i)=>{let o=e._zod.parse(r,i);if(o instanceof Promise){if(i.async===false)throw new a;return o.then((e=>t(e,n,i)))}return t(o,n,i)}}e["~standard"]={validate:t=>{try{let r=be(e,t);return r.success?{value:r.data}:{issues:r.error?.issues}}catch(r){return ye(e,t).then((e=>e.success?{value:e.data}:{issues:e.error?.issues}))}},vendor:"zod",version:1}})),je=s("$ZodString",((e,t)=>{$e.init(e,t),e._zod.pattern=[...e?._zod.bag?.patterns??[]].pop()??ve(e._zod.bag),e._zod.parse=(r,n)=>{if(t.coerce)try{r.value=String(r.value)}catch(e){}if(typeof r.value==="string")return r;return r.issues.push({expected:"string",code:"invalid_type",input:r.value,inst:e}),r}}));var Se=s("$ZodNumber",((e,t)=>{$e.init(e,t),e._zod.pattern=e._zod.bag.pattern??ge,e._zod.parse=(r,n)=>{if(t.coerce)try{r.value=Number(r.value)}catch(e){}let i=r.value;if(typeof i==="number"&&!Number.isNaN(i)&&Number.isFinite(i))return r;let o=typeof i==="number"?Number.isNaN(i)?"NaN":!Number.isFinite(i)?"Infinity":void 0:void 0;return r.issues.push({expected:"number",code:"invalid_type",input:i,inst:e,...o?{received:o}:{}}),r}}));var Oe=s("$ZodBoolean",((e,t)=>{$e.init(e,t),e._zod.pattern=xe,e._zod.parse=(r,n)=>{if(t.coerce)try{r.value=Boolean(r.value)}catch(e){}let i=r.value;if(typeof i==="boolean")return r;return r.issues.push({expected:"boolean",code:"invalid_type",input:i,inst:e}),r}}));var Re=s("$ZodNull",((e,t)=>{$e.init(e,t),e._zod.pattern=_e,e._zod.values=new Set([null]),e._zod.parse=(t,r)=>{let n=t.value;if(n===null)return t;return t.issues.push({expected:"null",code:"invalid_type",input:n,inst:e}),t}})),Te=s("$ZodAny",((e,t)=>{$e.init(e,t),e._zod.parse=e=>e}));function Pe(e,t,r){if(e.issues.length)t.issues.push(...ee(r,e.issues));t.value[r]=e.value}var Me=s("$ZodArray",((e,t)=>{$e.init(e,t),e._zod.parse=(r,n)=>{let i=r.value;if(!Array.isArray(i))return r.issues.push({expected:"array",code:"invalid_type",input:i,inst:e}),r;r.value=Array(i.length);let o=[];for(let e=0;e<i.length;e++){let s=i[e],a=t.element._zod.run({value:s,issues:[]},n);if(a instanceof Promise)o.push(a.then((t=>Pe(t,r,e))));else Pe(a,r,e)}if(o.length)return Promise.all(o).then((()=>r));return r}}));function Ne(e,t,r,n){if(e.issues.length)t.issues.push(...ee(r,e.issues));if(e.value===void 0){if(r in n)t.value[r]=void 0}else t.value[r]=e.value}var Ae=s("$ZodObject",((e,t)=>{$e.init(e,t);let r=v((()=>{let e=Object.keys(t.shape);for(let r of e)if(!(t.shape[r]instanceof $e))throw new Error(`Invalid element at key "${r}": expected a Zod schema`);let r=q(t.shape);return{shape:t.shape,keys:e,keySet:new Set(e),numKeys:e.length,optionalKeys:new Set(r)}}));k(e._zod,"propValues",(()=>{let e=t.shape,r={};for(let t in e){let n=e[t]._zod;if(n.values){r[t]??(r[t]=new Set);for(let e of n.values)r[t].add(e)}}return r}));let n=e=>{let t=new ke(["shape","payload","ctx"]),n=r.value,i=e=>{let t=T(e);return`shape[${t}]._zod.run({ value: input[${t}], issues: [] }, ctx)`};t.write("const input = payload.value;");let o=Object.create(null),s=0;for(let e of n.keys)o[e]=`key_${s++}`;t.write("const newResult = {}");for(let e of n.keys){let r=o[e],n=T(e);t.write(`const ${r} = ${i(e)};`),t.write(`\n        if (${r}.issues.length) {\n          payload.issues = payload.issues.concat(${r}.issues.map(iss => ({\n            ...iss,\n            path: iss.path ? [${n}, ...iss.path] : [${n}]\n          })));\n        }\n        \n        if (${r}.value === undefined) {\n          if (${n} in input) {\n            newResult[${n}] = undefined;\n          }\n        } else {\n          newResult[${n}] = ${r}.value;\n        }\n      `)}t.write("payload.value = newResult;"),t.write("return payload;");let a=t.compile();return(t,r)=>a(e,t,r)},i,o=M,s=!l.jitless,a=s&&N.value,u=t.catchall,c;e._zod.parse=(l,f)=>{c??(c=r.value);let d=l.value;if(!o(d))return l.issues.push({expected:"object",code:"invalid_type",input:d,inst:e}),l;let h=[];if(s&&a&&f?.async===false&&f.jitless!==true){if(!i)i=n(t.shape);l=i(l,f)}else{l.value={};let e=c.shape;for(let t of c.keys){let r=e[t]._zod.run({value:d[t],issues:[]},f);if(r instanceof Promise)h.push(r.then((e=>Ne(e,l,t,d))));else Ne(r,l,t,d)}}if(!u)return h.length?Promise.all(h).then((()=>l)):l;let p=[],m=c.keySet,b=u._zod,w=b.def.type;for(let e of Object.keys(d)){if(m.has(e))continue;if(w==="never"){p.push(e);continue}let t=b.run({value:d[e],issues:[]},f);if(t instanceof Promise)h.push(t.then((t=>Ne(t,l,e,d))));else Ne(t,l,e,d)}if(p.length)l.issues.push({code:"unrecognized_keys",keys:p,input:d,inst:e});if(!h.length)return l;return Promise.all(h).then((()=>l))}}));function Ce(e,t,r,n){for(let r of e)if(r.issues.length===0)return t.value=r.value,t;let i=e.filter((e=>!X(e)));if(i.length===1)return t.value=i[0].value,i[0];return t.issues.push({code:"invalid_union",input:t.value,inst:r,errors:e.map((e=>e.issues.map((e=>re(e,n,u())))))}),t}var ze=s("$ZodUnion",((e,t)=>{$e.init(e,t),k(e._zod,"optin",(()=>t.options.some((e=>e._zod.optin==="optional"))?"optional":void 0)),k(e._zod,"optout",(()=>t.options.some((e=>e._zod.optout==="optional"))?"optional":void 0)),k(e._zod,"values",(()=>{if(t.options.every((e=>e._zod.values)))return new Set(t.options.flatMap((e=>Array.from(e._zod.values))));return})),k(e._zod,"pattern",(()=>{if(t.options.every((e=>e._zod.pattern))){let e=t.options.map((e=>e._zod.pattern));return new RegExp(`^(${e.map((e=>x(e.source))).join("|")})$`)}return})),e._zod.parse=(r,n)=>{let i=false,o=[];for(let e of t.options){let t=e._zod.run({value:r.value,issues:[]},n);if(t instanceof Promise)o.push(t),i=true;else{if(t.issues.length===0)return t;o.push(t)}}if(!i)return Ce(o,r,e,n);return Promise.all(o).then((t=>Ce(t,r,e,n)))}}));var Le=s("$ZodRecord",((e,t)=>{$e.init(e,t),e._zod.parse=(r,n)=>{let i=r.value;if(!A(i))return r.issues.push({expected:"record",code:"invalid_type",input:i,inst:e}),r;let o=[];if(t.keyType._zod.values){let s=t.keyType._zod.values;r.value={};for(let e of s)if(typeof e==="string"||typeof e==="number"||typeof e==="symbol"){let s=t.valueType._zod.run({value:i[e],issues:[]},n);if(s instanceof Promise)o.push(s.then((t=>{if(t.issues.length)r.issues.push(...ee(e,t.issues));r.value[e]=t.value})));else{if(s.issues.length)r.issues.push(...ee(e,s.issues));r.value[e]=s.value}}let a;for(let e in i)if(!s.has(e))a=a??[],a.push(e);if(a&&a.length>0)r.issues.push({code:"unrecognized_keys",input:i,inst:e,keys:a})}else{r.value={};for(let s of Reflect.ownKeys(i)){if(s==="__proto__")continue;let a=t.keyType._zod.run({value:s,issues:[]},n);if(a instanceof Promise)throw new Error("Async schemas not supported in object keys currently");if(a.issues.length){r.issues.push({origin:"record",code:"invalid_key",issues:a.issues.map((e=>re(e,n,u()))),input:s,path:[s],inst:e}),r.value[a.value]=a.value;continue}let l=t.valueType._zod.run({value:i[s],issues:[]},n);if(l instanceof Promise)o.push(l.then((e=>{if(e.issues.length)r.issues.push(...ee(s,e.issues));r.value[a.value]=e.value})));else{if(l.issues.length)r.issues.push(...ee(s,l.issues));r.value[a.value]=l.value}}}if(o.length)return Promise.all(o).then((()=>r));return r}}));var Ze=s("$ZodOptional",((e,t)=>{$e.init(e,t),e._zod.optin="optional",e._zod.optout="optional",k(e._zod,"values",(()=>t.innerType._zod.values?new Set([...t.innerType._zod.values,void 0]):void 0)),k(e._zod,"pattern",(()=>{let e=t.innerType._zod.pattern;return e?new RegExp(`^(${x(e.source)})?$`):void 0})),e._zod.parse=(e,r)=>{if(t.innerType._zod.optin==="optional")return t.innerType._zod.run(e,r);if(e.value===void 0)return e;return t.innerType._zod.run(e,r)}}));function Ie(e,t){return new e({type:"string",...F(t)})}function Ue(e,t){return new e({type:"number",checks:[],...F(t)})}function Fe(e,t){return new e({type:"boolean",...F(t)})}function Be(e,t){return new e({type:"null",...F(t)})}function De(e){return new e({type:"any"})}var qe=s("ZodMiniType",((e,t)=>{if(!e._zod)throw new Error("Uninitialized schema in ZodMiniType.");$e.init(e,t),e.def=t,e.parse=(t,r)=>de(e,t,r,{callee:e.parse}),e.safeParse=(t,r)=>be(e,t,r),e.parseAsync=async(t,r)=>pe(e,t,r,{callee:e.parseAsync}),e.safeParseAsync=async(t,r)=>ye(e,t,r),e.check=(...r)=>e.clone({...t,checks:[...t.checks??[],...r.map((e=>typeof e==="function"?{_zod:{check:e,def:{check:"custom"},onattach:[]}}:e))]}),e.clone=(t,r)=>U(e,t,r),e.brand=()=>e,e.register=(t,r)=>(t.add(e,r),e)})),Je=s("ZodMiniString",((e,t)=>{je.init(e,t),qe.init(e,t)}));function Ke(e){return Ie(Je,e)}var Ge=s("ZodMiniNumber",((e,t)=>{Se.init(e,t),qe.init(e,t)}));function Ve(e){return Ue(Ge,e)}var We=s("ZodMiniBoolean",((e,t)=>{Oe.init(e,t),qe.init(e,t)}));function He(e){return Fe(We,e)}var Ye=s("ZodMiniNull",((e,t)=>{Re.init(e,t),qe.init(e,t)}));function Qe(e){return Be(Ye,e)}var Xe=s("ZodMiniAny",((e,t)=>{Te.init(e,t),qe.init(e,t)}));function et(){return De(Xe)}var tt=s("ZodMiniArray",((e,t)=>{Me.init(e,t),qe.init(e,t)}));function rt(e,t){return new tt({type:"array",element:e,...c.normalizeParams(t)})}var nt=s("ZodMiniObject",((e,t)=>{Ae.init(e,t),qe.init(e,t),c.defineLazy(e,"shape",(()=>t.shape))}));function it(e,t){let r={type:"object",get shape(){return c.assignProp(this,"shape",{...e}),this.shape},...c.normalizeParams(t)};return new nt(r)}var ot=s("ZodMiniUnion",((e,t)=>{ze.init(e,t),qe.init(e,t)}));function st(e,t){return new ot({type:"union",options:e,...c.normalizeParams(t)})}var at=s("ZodMiniRecord",((e,t)=>{Le.init(e,t),qe.init(e,t)}));function lt(e,t,r){return new at({type:"record",keyType:e,valueType:t,...c.normalizeParams(r)})}var ut=s("ZodMiniOptional",((e,t)=>{Ze.init(e,t),qe.init(e,t)}));function ct(e){return new ut({type:"optional",innerType:e})}var ft=Symbol.for,dt=Symbol("kCapture"),ht=ft("events.errorMonitor"),pt=Symbol("events.maxEventTargetListeners"),mt=Symbol("events.maxEventTargetListenersWarned"),bt=ft("nodejs.rejection"),wt=ft("nodejs.rejection"),yt=Array.prototype.slice,vt=10,gt=function e(t){if(this._events===void 0||this._events===this.__proto__._events)this._events={__proto__:null},this._eventsCount=0;if(this._maxListeners??=void 0,this[dt]=t?.captureRejections?Boolean(t?.captureRejections):xt[dt])this.emit=jt},xt=gt.prototype={};xt._events=void 0;xt._eventsCount=0;xt._maxListeners=void 0;xt.setMaxListeners=function e(t){return It(t,"setMaxListeners",0),this._maxListeners=t,this};xt.constructor=gt;xt.getMaxListeners=function e(){return this?._maxListeners??vt};function _t(e,t){var{_events:r}=e;if(t[0]??=new Error("Unhandled error."),!r)throw t[0];var n=r[ht];if(n)for(var i of yt.call(n))i.apply(e,t);var o=r.error;if(!o)throw t[0];for(var i of yt.call(o))i.apply(e,t);return true}function kt(e,t,r,n){t.then(void 0,(function(t){queueMicrotask((()=>Et(e,t,r,n)))}))}function Et(e,t,r,n){if(typeof e[bt]==="function")e[bt](t,r,...n);else try{e[dt]=false,e.emit("error",t)}finally{e[dt]=true}}var $t=function e(t,...r){if(t==="error")return _t(this,r);var{_events:n}=this;if(n===void 0)return false;var i=n[t];if(i===void 0)return false;let o=i.length>1?i.slice():i;for(let e=0,{length:t}=o;e<t;e++){let t=o[e];switch(r.length){case 0:t.call(this);break;case 1:t.call(this,r[0]);break;case 2:t.call(this,r[0],r[1]);break;case 3:t.call(this,r[0],r[1],r[2]);break;default:t.apply(this,r);break}}return true},jt=function e(t,...r){if(t==="error")return _t(this,r);var{_events:n}=this;if(n===void 0)return false;var i=n[t];if(i===void 0)return false;let o=i.length>1?i.slice():i;for(let e=0,{length:n}=o;e<n;e++){let n=o[e],i;switch(r.length){case 0:i=n.call(this);break;case 1:i=n.call(this,r[0]);break;case 2:i=n.call(this,r[0],r[1]);break;case 3:i=n.call(this,r[0],r[1],r[2]);break;default:i=n.apply(this,r);break}if(i!==void 0&&typeof i?.then==="function"&&i.then===Promise.prototype.then)kt(this,i,t,r)}return true};xt.emit=$t;xt.addListener=function e(t,r){Ut(r);var n=this._events;if(!n)n=this._events={__proto__:null},this._eventsCount=0;else if(n.newListener)this.emit("newListener",t,r.listener??r);var i=n[t];if(!i)n[t]=[r],this._eventsCount++;else{i.push(r);var o=this._maxListeners??vt;if(o>0&&i.length>o&&!i.warned)St(this,t,i)}return this};xt.on=xt.addListener;xt.prependListener=function e(t,r){Ut(r);var n=this._events;if(!n)n=this._events={__proto__:null},this._eventsCount=0;else if(n.newListener)this.emit("newListener",t,r.listener??r);var i=n[t];if(!i)n[t]=[r],this._eventsCount++;else{i.unshift(r);var o=this._maxListeners??vt;if(o>0&&i.length>o&&!i.warned)St(this,t,i)}return this};function St(e,t,r){r.warned=true;let n=new Error(`Possible EventEmitter memory leak detected. ${r.length} ${String(t)} listeners added to [${e.constructor.name}]. Use emitter.setMaxListeners() to increase limit`);n.name="MaxListenersExceededWarning",n.emitter=e,n.type=t,n.count=r.length,console.warn(n)}function Ot(e,t,...r){this.removeListener(e,t),t.apply(this,r)}xt.once=function e(t,r){Ut(r);let n=Ot.bind(this,t,r);return n.listener=r,this.addListener(t,n),this};xt.prependOnceListener=function e(t,r){Ut(r);let n=Ot.bind(this,t,r);return n.listener=r,this.prependListener(t,n),this};xt.removeListener=function e(t,r){Ut(r);var{_events:n}=this;if(!n)return this;var i=n[t];if(!i)return this;var o=i.length;let s=-1;for(let e=o-1;e>=0;e--)if(i[e]===r||i[e].listener===r){s=e;break}if(s<0)return this;if(s===0)i.shift();else i.splice(s,1);if(i.length===0)delete n[t],this._eventsCount--;return this};xt.off=xt.removeListener;xt.removeAllListeners=function e(t){var{_events:r}=this;if(t&&r){if(r[t])delete r[t],this._eventsCount--}else this._events={__proto__:null};return this};xt.listeners=function e(t){var{_events:r}=this;if(!r)return[];var n=r[t];if(!n)return[];return n.map((e=>e.listener??e))};xt.rawListeners=function e(t){var{_events:r}=this;if(!r)return[];var n=r[t];if(!n)return[];return n.slice()};xt.listenerCount=function e(t){var{_events:r}=this;if(!r)return 0;return r[t]?.length??0};xt.eventNames=function e(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]};xt[dt]=false;function Rt(e,t,r){var n=r?.signal;if(Zt(n,"options.signal"),n?.aborted)throw new Ct(void 0,{cause:n?.reason});let{resolve:i,reject:o,promise:s}=$newPromiseCapability(Promise),a=r=>{if(e.removeListener(t,l),n!=null)Nt(n,"abort",u);o(r)},l=(...t)=>{if(typeof e.removeListener==="function")e.removeListener("error",a);if(n!=null)Nt(n,"abort",u);i(t)};if(At(e,t,l,{once:true}),t!=="error"&&typeof e.once==="function")e.once("error",a);function u(){Nt(e,t,l),Nt(e,"error",a),o(new Ct(void 0,{cause:n?.reason}))}if(n!=null)At(n,"abort",u,{once:true});return s}function Tt(e,t){return e.listeners(t)}function Pt(e,...t){It(e,"setMaxListeners",0);var r;if(t&&(r=t.length))for(let n=0;n<r;n++)t[n].setMaxListeners(e);else vt=e}function Mt(e,t){return e.listenerCount(t)}function Nt(e,t,r,n){if(typeof e.removeListener==="function")e.removeListener(t,r);else e.removeEventListener(t,r,n)}function At(e,t,r,n){if(typeof e.on==="function")if(n.once)e.once(t,r);else e.on(t,r);else e.addEventListener(t,r,n)}class Ct extends Error{constructor(e="The operation was aborted",t=void 0){if(t!==void 0&&typeof t!=="object")throw zt("options","Object",t);super(e,t);this.code="ABORT_ERR",this.name="AbortError"}}function zt(e,t,r){let n=new TypeError(`The "${e}" argument must be of type ${t}. Received ${r}`);return n.code="ERR_INVALID_ARG_TYPE",n}function Lt(e,t,r){let n=new RangeError(`The "${e}" argument is out of range. It must be ${t}. Received ${r}`);return n.code="ERR_OUT_OF_RANGE",n}function Zt(e,t){if(e!==void 0&&(e===null||typeof e!=="object"||!("aborted"in e)))throw zt(t,"AbortSignal",e)}function It(e,t,r,n){if(typeof e!=="number")throw zt(t,"number",e);if(e<r||n!=null||Number.isNaN(e))throw Lt(t,`${`>= ${r}`}${""}${""}`,e)}function Ut(e){if(typeof e!=="function")throw new TypeError("The listener must be a function")}function Ft(e,t){if(typeof e!=="boolean")throw zt(t,"boolean",e)}function Bt(e){return e?._maxListeners??vt}function Dt(e,t){if(e===void 0)throw zt("signal","AbortSignal",e);if(Zt(e,"signal"),typeof t!=="function")throw zt("listener","function",t);let r;if(e.aborted)queueMicrotask((()=>t()));else e.addEventListener("abort",t,{__proto__:null,once:true}),r=()=>{e.removeEventListener("abort",t)};return{__proto__:null,[Symbol.dispose](){r?.()}}}Object.defineProperties(gt,{captureRejections:{get(){return xt[dt]},set(e){Ft(e,"EventEmitter.captureRejections"),xt[dt]=e},enumerable:true},defaultMaxListeners:{enumerable:true,get:()=>vt,set:e=>{It(e,"defaultMaxListeners",0),vt=e}},kMaxEventTargetListeners:{value:pt,enumerable:false,configurable:false,writable:false},kMaxEventTargetListenersWarned:{value:mt,enumerable:false,configurable:false,writable:false}});Object.assign(gt,{once:Rt,getEventListeners:Tt,getMaxListeners:Bt,setMaxListeners:Pt,EventEmitter:gt,usingDomains:false,captureRejectionSymbol:wt,errorMonitor:ht,addAbortListener:Dt,init:gt,listenerCount:Mt});var qt=it({id:Ve(),email:Ke(),newsletter_internal_name:Ke(),preference_identifiers:rt(Ke()),preference_token:Ke(),confirmed_at:st([Ke(),Qe()])}),Jt=it({newsletter_internal_name:Ke(),error_identifier:Ke()}),Kt=it({results:rt(qt),errors:rt(Jt)}),Gt=it({email:Ke(),newsletter_subscriptions:rt(it({newsletter_internal_name:Ke(),preference_identifiers:ct(rt(Ke()))})),return_to_after_confirmation:ct(Ke())});class Vt extends gt{client;constructor(e){super();this.client=e}async createSubscriptions(e){Gt.parse(e);let t=await this.client.post("/api/sdk/v1/newsletter_subscriptions",e);switch(t.status){case 429:return this.emit("rate_limit_exceeded",t),["rate_limit_exceeded",t];case 500:return["server_error",t];case 0:return["network_error",t];default:if(t.data)try{if(Kt.parse(t.data).errors.length>0)return this.emit("newsletter_error",t),["newsletter_error",t];return[null,t]}catch(e){return["schema_validation_error",t]}return["error",t]}}async resendDoi(e,t){return(await this.client.post(`/api/sdk/v1/newsletters/${e}/resend_doi`,{email:t})).status===204}onError(e,t){this.on("newsletter_error",(r=>{if(!r.data?.errors)return;let n=t?r.data.errors.filter((e=>e.error_identifier===t)):r.data.errors;if(n.length>0)e(n)}))}onRateLimitError(e){this.on("rate_limit_exceeded",(t=>{if(t.status===429)e()}))}}var Wt=it({value:Ke(),label:Ke()});st([He(),it({locked:He(),locked_text:Ke()})]);var Ht=it({value:et(),type:Ke(),required:He(),label:Ke(),locked:st([He(),it({locked:He(),locked_text:Ke()})]),options:st([rt(Wt),Qe()])}),Yt=lt(Ke(),Ht);it({salutation:Ht,first_name:Ht,last_name:Ht,email:Ht,phone_number:Ht,company_name:Ht,address_line_1:Ht,address_line_2:Ht,city:Ht,postal_code:Ht,country_code:Ht,date_of_birth:Ht,custom_attributes:Yt});class Qt{client;constructor(e){this.client=e}async fetchProfile(e){let t=e??window.UNIDY?.auth?.id_token;if(!t)return{status:401,success:false,headers:new Headers,error:"missing id_token"};try{return await this.client.post("/api/sdk/v1/profile",{id_token:t})}catch(e){return{status:e instanceof TypeError?0:500,success:false,headers:new Headers,error:e instanceof Error?e.message:String(e)}}}}class Xt{apiClient;newsletters;profile;constructor(e,t){this.apiClient=new o(e,t),this.newsletters=new Vt(this.apiClient),this.profile=new Qt(this.apiClient)}}const er='/*! tailwindcss v4.1.11 | MIT License | https://tailwindcss.com */@layer properties{@supports (((-webkit-hyphens:none)) and (not (margin-trim:inline))) or ((-moz-orient:inline) and (not (color:rgb(from red r g b)))){*,::backdrop,:after,:before{--tw-border-style:solid;--tw-font-weight:initial;--tw-shadow:0 0 #0000;--tw-shadow-color:initial;--tw-shadow-alpha:100%;--tw-inset-shadow:0 0 #0000;--tw-inset-shadow-color:initial;--tw-inset-shadow-alpha:100%;--tw-ring-color:initial;--tw-ring-shadow:0 0 #0000;--tw-inset-ring-color:initial;--tw-inset-ring-shadow:0 0 #0000;--tw-ring-inset:initial;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-offset-shadow:0 0 #0000}}}@layer theme{:host,:root{--font-sans:ui-sans-serif,system-ui,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";--font-mono:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;--spacing:.25rem;--container-lg:32rem;--text-lg:1.125rem;--text-lg--line-height:1.55556;--font-weight-medium:500;--font-weight-bold:700;--default-font-family:var(--font-sans);--default-mono-font-family:var(--font-mono)}}@layer base{*,::backdrop,:after,:before{border:0 solid;box-sizing:border-box;margin:0;padding:0}::file-selector-button{appearance:button;background-color:#0000;border:0 solid;border-radius:0;box-sizing:border-box;color:inherit;font:inherit;font-feature-settings:inherit;font-variation-settings:inherit;letter-spacing:inherit;margin:0;margin-inline-end:4px;opacity:1;padding:0}:host,html{-webkit-text-size-adjust:100%;font-family:var(--default-font-family,ui-sans-serif,system-ui,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji");font-feature-settings:var(--default-font-feature-settings,normal);font-variation-settings:var(--default-font-variation-settings,normal);line-height:1.5;tab-size:4;-webkit-tap-highlight-color:transparent}hr{border-top-width:1px;color:inherit;height:0}abbr:where([title]){-webkit-text-decoration:underline dotted;text-decoration:underline dotted}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;-webkit-text-decoration:inherit;text-decoration:inherit}b,strong{font-weight:bolder}code,kbd,pre,samp{font-family:var(--default-mono-font-family,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace);font-feature-settings:var(--default-mono-font-feature-settings,normal);font-size:1em;font-variation-settings:var(--default-mono-font-variation-settings,normal)}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}table{border-collapse:collapse;border-color:inherit;text-indent:0}:-moz-focusring{outline:auto}progress{vertical-align:baseline}summary{display:list-item}menu,ol,ul{list-style:none}audio,canvas,embed,iframe,img,object,svg,video{display:block;vertical-align:middle}img,video{height:auto;max-width:100%}button,input,optgroup,select,textarea{background-color:#0000;border-radius:0;color:inherit;font:inherit;font-feature-settings:inherit;font-variation-settings:inherit;letter-spacing:inherit;opacity:1}:where(select:is([multiple],[size])) optgroup{font-weight:bolder}:where(select:is([multiple],[size])) optgroup option{padding-inline-start:20px}::placeholder{opacity:1}@supports (not ((-webkit-appearance:-apple-pay-button))) or (contain-intrinsic-size:1px){::placeholder{color:currentColor}@supports (color:color-mix(in lab,red,red)){::placeholder{color:color-mix(in oklab,currentcolor 50%,transparent)}}}textarea{resize:vertical}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-date-and-time-value{min-height:1lh;text-align:inherit}::-webkit-datetime-edit{display:inline-flex;padding-block:0}::-webkit-datetime-edit-fields-wrapper{padding:0}::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-year-field{padding-block:0}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-hour-field{padding-block:0}::-webkit-datetime-edit-minute-field,::-webkit-datetime-edit-second-field{padding-block:0}::-webkit-datetime-edit-meridiem-field,::-webkit-datetime-edit-millisecond-field{padding-block:0}:-moz-ui-invalid{box-shadow:none}button,input:where([type=button],[type=reset],[type=submit]){appearance:button}::-webkit-inner-spin-button,::-webkit-outer-spin-button{height:auto}[hidden]:where(:not([hidden=until-found])){display:none!important}}@layer components;@layer utilities{.container{width:100%}.mr-2{margin-right:calc(var(--spacing)*2)}.ml-2{margin-left:calc(var(--spacing)*2)}.flex{display:flex}.w-full{width:100%}.max-w-lg{max-width:var(--container-lg)}.cursor-pointer{cursor:pointer}.flex-col{flex-direction:column}.items-center{align-items:center}.gap-2{gap:calc(var(--spacing)*2)}.border{border-style:var(--tw-border-style);border-width:1px}.text-lg{font-size:var(--text-lg);line-height:var(--tw-leading,var(--text-lg--line-height))}.font-bold{--tw-font-weight:var(--font-weight-bold);font-weight:var(--font-weight-bold)}.font-medium{--tw-font-weight:var(--font-weight-medium);font-weight:var(--font-weight-medium)}.underline{text-decoration-line:underline}.shadow{--tw-shadow:0 1px 3px 0 var(--tw-shadow-color,#0000001a),0 1px 2px -1px var(--tw-shadow-color,#0000001a);box-shadow:var(--tw-inset-shadow),var(--tw-inset-ring-shadow),var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow)}} /*! tailwindcss v4.1.11 | MIT License | https://tailwindcss.com */@layer properties{}@layer base{}@layer components;:host{--tw-border-style:solid;display:block}@property --tw-border-style{syntax:"*";inherits:false;initial-value:solid}@property --tw-font-weight{syntax:"*";inherits:false}@property --tw-shadow{syntax:"*";inherits:false;initial-value:0 0 #0000}@property --tw-shadow-color{syntax:"*";inherits:false}@property --tw-shadow-alpha{syntax:"<percentage>";inherits:false;initial-value:100%}@property --tw-inset-shadow{syntax:"*";inherits:false;initial-value:0 0 #0000}@property --tw-inset-shadow-color{syntax:"*";inherits:false}@property --tw-inset-shadow-alpha{syntax:"<percentage>";inherits:false;initial-value:100%}@property --tw-ring-color{syntax:"*";inherits:false}@property --tw-ring-shadow{syntax:"*";inherits:false;initial-value:0 0 #0000}@property --tw-inset-ring-color{syntax:"*";inherits:false}@property --tw-inset-ring-shadow{syntax:"*";inherits:false;initial-value:0 0 #0000}@property --tw-ring-inset{syntax:"*";inherits:false}@property --tw-ring-offset-width{syntax:"<length>";inherits:false;initial-value:0}@property --tw-ring-offset-color{syntax:"*";inherits:false;initial-value:#fff}@property --tw-ring-offset-shadow{syntax:"*";inherits:false;initial-value:0 0 #0000}@media (min-width:40rem){.container{max-width:40rem}}@media (min-width:48rem){.container{max-width:48rem}}@media (min-width:64rem){.container{max-width:64rem}}@media (min-width:80rem){.container{max-width:80rem}}@media (min-width:96rem){.container{max-width:96rem}}';const tr=class{constructor(r){e(this,r);this.successEvent=t(this,"on:success");this.errorEvent=t(this,"on:error");this.resetStatus=t(this,"resetStatus")}header;newslettersConfig=[];newslettersConfigJson;additionalFields=[];additionalFieldsConfigJson;submitButtonText="Subscribe";emailLabel="Email";emailPlaceholder="Email";apiUrl;apiKey;returnToAfterConfirmation;renderErrorMessages=false;errorUnconfirmedText="Your email is not confirmed.";errorAlreadySubscribedText="Already subscribed";errorInvalidEmailText="Invalid email address";errorNewsletterNotFoundText="Newsletter not found";errorPreferenceNotFoundText="Preference not found";errorUnknownText="Unknown error occured";errorResendConfirmationActionText="Resend confirmation email";errorResendConfirmationSuccessText="Please check your inbox for the confirmation email.";successConfirmationText="You have successfully confirmed your newsletter subscription.";confirmationErrorText="Your preference token could not be assigned. Enter your e-mail address to receive a new link.";email="";checkedNewsletters={};additionalFieldValues={};errors={};showSubscribeSuccessSlot=false;showConfirmSuccessSlot=false;showConfirmationErrorSlot=false;resendingDoi=[];successEvent;errorEvent;resetStatus;client;componentWillLoad(){window.addEventListener("unidy:auth",(e=>{const{userData:t}=e.detail;if(t){this.prefillForm(t)}}));this.client=new Xt(this.apiUrl,this.apiKey);if(this.newslettersConfigJson){try{this.newslettersConfig=JSON.parse(this.newslettersConfigJson)}catch(e){console.error("Failed to parse newslettersConfigJson:",e)}}if(this.additionalFieldsConfigJson){try{this.additionalFields=JSON.parse(this.additionalFieldsConfigJson)}catch(e){console.error("Failed to parse additionalFieldsConfigJson:",e)}}this.checkedNewsletters=this.newslettersConfig.reduce(((e,t)=>{e[t.internalName]={preferences:t.preferences?.filter((e=>e.checked)).map((e=>e.internalName))||[],checked:t.checked};return e}),{});const e=new URLSearchParams(window.location.search);const t=e.get("newsletter_error");const r=e.get("selected");if(t){this.handleConfirmationError()}else if(r){this.handleConfirmationSuccess()}}prefillForm(e){if(e?.email&&typeof e.email==="string"&&!this.email){this.email=e.email}if(this.additionalFields.length>0){const t={};for(const r of this.additionalFields){const n=e[r.name];if(n){t[r.name]=n}}this.additionalFieldValues=t}}handleConfirmationError(){this.showConfirmSuccessSlot=false;this.showSubscribeSuccessSlot=false;this.showConfirmationErrorSlot=true;setTimeout((()=>{this.resetStatus.emit();const e=new URL(window.location.href);e.searchParams.delete("newsletter_error");window.history.replaceState({},document.title,e.pathname+e.search)}),5e3)}handleConfirmationSuccess(){this.showConfirmSuccessSlot=true;this.showSubscribeSuccessSlot=false;setTimeout((()=>{this.showConfirmSuccessSlot=false;this.resetStatus.emit()}),5e3)}buildReturnUrlWithoutConfirmedParams(){const e=`${location.origin}${location.pathname}`;const t=new URLSearchParams(location.search);for(const e of["email","selected"]){t.delete(e)}const r=t.toString();return r?`${e}?${r}`:e}handleResendDoi=async(e,t)=>{this.client.newsletters.resendDoi(e,t);this.resendingDoi=[...this.resendingDoi,e]};handleSubmit=async e=>{e.preventDefault();this.errors={};this.showSubscribeSuccessSlot=false;const t=Object.entries(this.additionalFieldValues).filter((([e])=>e.startsWith("custom_attribute:"))).reduce(((e,[t,r])=>{const n=t.replace("custom_attribute:","");e[n]=r;return e}),{});const r=Object.entries(this.additionalFieldValues).filter((([e])=>!e.startsWith("custom_attribute:"))).reduce(((e,[t,r])=>{e[t]=r;return e}),{});const n={email:this.email,newsletter_subscriptions:[],return_to_after_confirmation:this.returnToAfterConfirmation||this.buildReturnUrlWithoutConfirmedParams(),additional_fields:{...r,custom_attributes:t}};const i=Object.entries(this.checkedNewsletters).filter((([e,t])=>t.checked)).map((([e,t])=>({newsletter_internal_name:e,preference_identifiers:t.preferences})));if(i.length===0){console.error("No newsletters selected: please select at least one newsletter");return}n.newsletter_subscriptions=i;const[o,s]=await this.client.newsletters.createSubscriptions(n);if(o){if(o==="newsletter_error"){const e=s.data?.errors||[];this.errorEvent.emit(e);const t={};for(const r of e){t[r.newsletter_internal_name]={error_identifier:r.error_identifier}}this.errors={...this.errors,...t};return}if(o==="rate_limit_exceeded"){alert("Rate limit exceeded. Please try again later.")}}else{this.showSubscribeSuccessSlot=true;this.successEvent.emit(s.data.results)}this.email=""};getErrorText(e){switch(e){case"unconfirmed":return this.errorUnconfirmedText;case"already_subscribed":return this.errorAlreadySubscribedText;case"invalid_email":return this.errorInvalidEmailText;case"newsletter_not_found":return this.errorNewsletterNotFoundText;case"preferences_not_found":return this.errorPreferenceNotFoundText;default:return this.errorUnknownText}}toggleNewsletter(e){const t=this.checkedNewsletters[e];const r=!t.checked;this.checkedNewsletters={...this.checkedNewsletters,[e]:{...t,checked:r,preferences:r?t.preferences:[]}}}togglePreference(e,t){const r=this.checkedNewsletters[e];if(!r||!r.checked)return;const n=r.preferences||[];const i=n.includes(t);const o=i?n.filter((e=>e!==t)):[...n,t];this.checkedNewsletters={...this.checkedNewsletters,[e]:{...r,preferences:o}}}renderErrorMessage(e){if(!this.renderErrorMessages||!this.errors[e]){return null}const t=this.errors[e];const n=t.error_identifier;const i=n==="unconfirmed";const o=this.resendingDoi.includes(e);return r("div",{key:`error-${e}-${n}`,part:`error-message ${n}`,class:`${n}`},!i&&this.getErrorText(n),i&&!o&&r(r.Fragment,null,this.errorUnconfirmedText,r("button",{type:"button",onClick:()=>this.handleResendDoi(e,this.email),part:"resend-doi-button",class:"ml-2 underline cursor-pointer"},this.errorResendConfirmationActionText)),i&&o&&r("span",{part:"resending-doi-text",class:"ml-2"},this.errorResendConfirmationSuccessText))}render(){return r("div",{key:"bf498bb47b84c6975dd65c682ad715c817b72fe1",part:"container",class:"max-w-lg"},r("slot",{key:"13f448071f7c402b09de69364b30abe2ee923132",name:"header"}),this.header&&r("h1",{key:"1b0030f857d3313aca433f0ac1ef259d425e397a",part:"heading"},this.header),r("slot",{key:"c383ece65976db1a13674fef7710038f892a1d48",name:"description"}),r("form",{key:"6a138e31f4529aad4660629625ab869751972543",onSubmit:this.handleSubmit,class:"flex flex-col gap-2"},r("div",{key:"668387bcb0ec18684838ea4da11cfe0971512eb3",part:"email-input-group"},r("label",{key:"af3d562a23e96e272582ba54cee273cdfec6774b",part:"email-input-label",htmlFor:"email-input"},this.emailLabel),r("input",{key:"bf0cc4b458ced8061b24779032d52340bdc433ce",id:"email-input",type:"email",part:"email-input",required:true,placeholder:this.emailPlaceholder,value:this.email,onInput:e=>{this.email=e.target.value},class:"w-full border"})),this.additionalFields.length>0&&this.additionalFields.map((e=>r("div",{key:e.name,class:"flex flex-col gap-2",part:"additional-field-input-group"},r("label",{htmlFor:e.name,part:"additional-field-label"},e.label),r("input",{name:e.name,type:e.type,part:"additional-field-input",required:e.required,value:this.additionalFieldValues[e.name]||"",onInput:t=>{this.additionalFieldValues={...this.additionalFieldValues,[e.name]:t.target.value}}})))),(this.newslettersConfig.length>1||this.newslettersConfig[0].preferences?.length>0)&&this.newslettersConfig.map((e=>r("div",{key:e.internalName,class:"flex flex-col gap-2",part:"newsletter-container"},this.newslettersConfig.length>1&&r("div",{class:"flex items-center gap-2"},r("label",{class:"font-bold text-lg",htmlFor:e.internalName,part:"newsletter-label"},e.label),r("input",{type:"checkbox",id:e.internalName,value:e.internalName,checked:this.checkedNewsletters[e.internalName].checked,onChange:()=>this.toggleNewsletter(e.internalName),part:"newsletter-checkbox"})),e.preferences&&this.checkedNewsletters[e.internalName].checked&&r("div",{class:`${this.newslettersConfig.length>1?"ml-2":""}`,part:"newsletter-preferences-container"},e.preferences.map((t=>r("label",{key:t.internalName,class:"flex items-center",part:"newsletter-preference-label"},r("input",{type:"checkbox",id:`${e.internalName}-${t.internalName}`,value:t.internalName,checked:this.checkedNewsletters[e.internalName]?.preferences.includes(t.internalName),onChange:()=>this.togglePreference(e.internalName,t.internalName),class:"mr-2",part:"newsletter-preference-checkbox"}),r("span",{class:"font-medium"},t.label))))),this.renderErrorMessage(e.internalName)))),this.newslettersConfig.length===1&&!this.newslettersConfig[0].preferences?.length&&this.renderErrorMessage(this.newslettersConfig[0].internalName),r("button",{key:"fa07e52f7274345bdf9bc4ef22e16f64f5c5df19",part:"submit-button",type:"submit",class:"w-full border"},this.submitButtonText),this.showSubscribeSuccessSlot&&r("slot",{key:"404740a359c04393ead3fcf5cf497de8dfec3712",name:"success-container"}),this.showConfirmSuccessSlot&&r("slot",{key:"25b8fd9886e777004ac1856769a807890fec3c0a",name:"confirm-success-container"},r("p",{key:"e3eb9d9f286b2b3bcf1ecb4e52a708eeede36dea",part:"confirm-success-text"},this.successConfirmationText)),this.showConfirmationErrorSlot&&r("slot",{key:"b23107f6e3c1a949c333d2c17ec6e1fe146e80c1",name:"confirmation-error-container"},r("p",{key:"928d9e969bba9d47caaa097d2fefb75b7c453672",part:"confirmaton-error-text"},this.confirmationErrorText))),r("slot",{key:"336ab414c9764e95b0de98a0a81dcc2856baeff4",name:"footer"}))}};tr.style=er;export{tr as unidy_newsletter};